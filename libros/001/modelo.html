<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plataforma de Contenido y Actividades</title>
    <link rel="stylesheet" href="/static/css/main.css">
</head>
<body>

    <header class="course-header">
        <div class="logo-container">
            <div class="logo">AP</div>
            <div class="course-title-info">
                <div class="clase-info">M√≥dulo Actual ‚Ä¢ Nombre del Curso</div>
                <div class="course-name">T√≠tulo Principal del Contenido</div>
            </div>
        </div>
        <div class="header-actions">
            <button>Ver M√≥dulos</button>
            <button class="siguiente-clase">Siguiente Contenido ‚Üí</button>
        </div>
    </header>

    <div class="main-container">
        <aside class="left-sidebar">
            <h3>Lecciones del M√≥dulo</h3>
            <ul id="lessonList">
                <li data-content-type="video" data-content-src="placeholder_video">1. Introducci√≥n (Video)</li>
                <li data-content-type="html" data-content-src="008 - resumen teoria.html">2. Resumen Te√≥rico (HTML)</li>
                <li>3. Ejemplos Pr√°cticos</li>
                <li>4. Herramientas y T√©cnicas</li>
                <li>5. Conclusiones del M√≥dulo</li>
            </ul>
            <br>
            <h3>Recursos Adicionales</h3>
            <ul>
                <li><a href="#" download>Gu√≠a descargable (PDF)</a></li>
                <li><a href="https://www.aspergerparaasperger.org/" target="_blank">Enlaces de Inter√©s APA</a></li>
                <li><a href="#">Glosario de T√©rminos</a></li>
            </ul>
        </aside>

        <main class="content-loader-area" id="mainContentArea">
            <div class="video-player-wrapper" id="videoPlayerWrapper">
                <img src="https://via.placeholder.com/1600x900.png/0D1F33/E0E7EF?Text=Selecciona+una+lecci%C3%B3n+o+actividad" alt="Contenido Principal" class="placeholder-image" id="mainPlaceholderImage">
            </div>
        </main>

        <aside class="right-sidebar">
            <h3>Actividades y Juegos</h3>
            <ul class="activity-list">
                <li><span class="icon">üìà</span> <a href="001 - Simulador.html" class="internal-activity-link">Simulador de Inter√©s Compuesto</a></li>
                <li><span class="icon">üé°</span> <a href="002 - Rueda decisiones financieras.html" class="internal-activity-link">Rueda de Decisiones</a></li>
                <li><span class="icon">üéØ</span> <a href="003 - planificador financiero.html" class="internal-activity-link">Planificador "Suficiente"</a></li>
                <li><span class="icon">üïµÔ∏è</span> <a href="004 - Detective de Riqueza.html" class="internal-activity-link">Detective de Riqueza</a></li>
                <li><span class="icon">‚è≥</span> <a href="005 - Gestor Linea Tiempo Inversion.html" class="internal-activity-link">Gestor de Inversi√≥n</a></li>
                <li><span class="icon">üß†</span> <a href="006 - FlashCard.html" class="internal-activity-link">Flashcards: Conceptos Clave</a></li>
                <li><span class="icon">‚úîÔ∏è</span> <a href="007 - verdero o falso.html" class="internal-activity-link">Verdadero o Falso</a></li>
                <li><span class="icon">üìú</span> <a href="008 - resumen teoria.html" class="internal-activity-link">Resumen Te√≥rico (Actividad)</a></li>
            </ul>
            <h3 style="margin-top: 30px;">Lecturas Recomendadas</h3>
            <ul class="activity-list">
                 <li><span class="icon">üìñ</span> <a href="URL_ARTICULO_EXTERNO_1" target="_blank">Art√≠culo sobre Psicolog√≠a Financiera</a></li>
                 <li><span class="icon">üìö</span> <a href="URL_LIBRO_EXTERNO" target="_blank">Libro: El Comportamiento del Dinero</a></li>
            </ul>
        </aside>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        const mainContentArea = document.getElementById('mainContentArea');
        const videoPlayerWrapper = document.getElementById('videoPlayerWrapper');
        const mainPlaceholderImage = document.getElementById('mainPlaceholderImage');
        const mainPlaceholderImageSrc = mainPlaceholderImage ? mainPlaceholderImage.src : 'https://via.placeholder.com/1600x900.png/0D1F33/E0E7EF?Text=Contenido+no+disponible';

        const activityLinks = document.querySelectorAll('a.internal-activity-link');
        const lessonItems = document.querySelectorAll('#lessonList li');

        function executeScriptsInElement(element) {
            const scripts = element.querySelectorAll('script');
            scripts.forEach(oldScript => {
                const newScript = document.createElement('script');
                Array.from(oldScript.attributes).forEach(attr => {
                    newScript.setAttribute(attr.name, attr.value);
                });
                if (oldScript.innerHTML) {
                    newScript.innerHTML = oldScript.innerHTML;
                }
                oldScript.parentNode.replaceChild(newScript, oldScript);
            });
        }

        function loadContent(url, isActivity = true) {
            fetch(url)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok: ' + response.statusText + ' para ' + url);
                    }
                    return response.text();
                })
                .then(html => {
                    if (isActivity) {
                        mainContentArea.innerHTML = `<div class="loaded-html-content">${html}</div>`;
                        executeScriptsInElement(mainContentArea.querySelector('.loaded-html-content'));
                    } else { // Para contenido de lecci√≥n cargado como HTML
                        mainContentArea.innerHTML = ''; // Limpiar √°rea principal
                         // Crear un wrapper si es necesario o cargar directamente si el HTML es un fragmento
                        const lessonContentWrapper = document.createElement('div');
                        lessonContentWrapper.className = 'loaded-html-content'; // Reusar estilo o crear uno nuevo
                        lessonContentWrapper.innerHTML = html;
                        mainContentArea.appendChild(lessonContentWrapper);
                        executeScriptsInElement(lessonContentWrapper);
                    }
                })
                .catch(error => {
                    console.error('Error al cargar el contenido:', error);
                    const errorMessage = `<div class="loaded-html-content"><p style="color:red; padding:20px;">${error.message}. Por favor, verifica la ruta del archivo y que el servidor local est√© funcionando si es necesario.</p></div>`;
                    mainContentArea.innerHTML = errorMessage;
                });
        }
        
        activityLinks.forEach(link => {
            link.addEventListener('click', function(event) {
                event.preventDefault();
                lessonItems.forEach(i => i.classList.remove('active')); // Desmarcar lecciones
                const url = this.getAttribute('href');
                loadContent(url, true);
            });
        });

        lessonItems.forEach(item => {
            item.addEventListener('click', function() {
                lessonItems.forEach(i => i.classList.remove('active'));
                this.classList.add('active');

                const contentType = this.dataset.contentType;
                const contentSrc = this.dataset.contentSrc;

                if (contentType === 'video' && contentSrc === 'placeholder_video') {
                    mainContentArea.innerHTML = ''; // Limpiar
                    const newVideoWrapper = document.createElement('div'); // Crear nuevo video wrapper
                    newVideoWrapper.className = 'video-player-wrapper';
                    newVideoWrapper.id = 'videoPlayerWrapper';
                    newVideoWrapper.innerHTML = `<img src="${mainPlaceholderImageSrc}" alt="Contenido Principal" class="placeholder-image" id="mainPlaceholderImage">`;
                    mainContentArea.appendChild(newVideoWrapper);
                } else if (contentType === 'html' && contentSrc) {
                    loadContent(contentSrc, false); // Cargar como contenido de lecci√≥n
                } else {
                    mainContentArea.innerHTML = ''; // Limpiar
                    const newVideoWrapper = document.createElement('div');
                    newVideoWrapper.className = 'video-player-wrapper';
                    newVideoWrapper.id = 'videoPlayerWrapper';
                    newVideoWrapper.innerHTML = `<img src="https://via.placeholder.com/1600x900.png/0D1F33/E0E7EF?Text=Contenido+de+la+lecci%C3%B3n:+${this.textContent.trim()}" alt="Contenido de Lecci√≥n" class="placeholder-image">`;
                    mainContentArea.appendChild(newVideoWrapper);
                }
            });
        });

        // Cargar contenido de la primera lecci√≥n (o un placeholder) al inicio si se desea
        if (lessonItems.length > 0) {
           // lessonItems[0].click(); // Simular clic en la primera lecci√≥n
           // O simplemente dejar el placeholder inicial que est√° en el HTML.
        }

    });
    </script>

</body>
</html>
