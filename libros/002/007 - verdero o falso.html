<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Verdadero o Falso: Desaf√≠o Housel üßê</title>
    <link rel="stylesheet" href="/static/css/main.css">
</head>
<body>
    <div class="vf-game-wrapper">
        <div class="game-container">
            <h1>Verdadero o Falso: Desaf√≠o Housel üßê</h1>

            <div class="question-area">
                <p id="questionText"></p> 
            </div>

            <div class="answer-buttons">
                <button id="trueButton" onclick="handleAnswer(true)">Verdadero</button>
                <button id="falseButton" onclick="handleAnswer(false)">Falso</button>
            </div>

            <div class="feedback-area" id="feedbackArea" style="display:none;">
                <p><strong id="feedbackResult"></strong></p>
                <p>Respuesta Correcta: <span id="correctAnswerText"></span></p>
                <p>Explicaci√≥n: <span id="explanationText"></span></p>
            </div>

            <div class="navigation-controls">
                <button id="prevButton" onclick="previousQuestion()">‚¨ÖÔ∏è Anterior</button>
                <span id="questionCounter">Pregunta 0 / 0</span>
                <button id="nextButton" onclick="nextQuestion()">Siguiente ‚û°Ô∏è</button>
            </div>
            <p id="scoreDisplay" style="margin-top: 15px;">Puntuaci√≥n: 0 / 0</p>
            <div class="final-score" id="finalScoreArea" style="display:none;">
                <h2>¬°Juego Terminado!</h2>
                <p id="finalScoreText"></p>
                <button onclick="initializeGame()">Jugar de Nuevo</button>
            </div>
        </div>
    </div>

    <script>
    // Envolvemos todo el script en un IIFE para crear un √°mbito privado
    (function() {
        const questions = [
            { statement: "Seg√∫n Morgan Housel, la inteligencia y la educaci√≥n formal en finanzas son los √∫nicos factores determinantes para el √©xito financiero.", correctAnswer: false, explanation: "Housel argumenta que el comportamiento es mucho m√°s determinante que la inteligencia o la educaci√≥n formal. (Introducci√≥n, Clave de Respuestas del Quiz)" },
            { statement: "La psicolog√≠a del dinero se ense√±a correctamente cuando se enfoca exclusivamente en modelos matem√°ticos y f√≥rmulas, ignorando las emociones.", correctAnswer: false, explanation: "Sugiere que se ense√±a incorrectamente precisamente porque ignora el papel de las emociones y el comportamiento. (Clave de Respuestas del Quiz)" },
            { statement: "\"Ser adinerado\" (tener altos ingresos) es exactamente lo mismo que \"ser rico\" (poseer riqueza).", correctAnswer: false, explanation: "Housel distingue claramente: el dinero es lo que ganas, la riqueza es lo que no gastas y acumulas. (Clave de Respuestas del Quiz, Glosario)" },
            { statement: "El autor argumenta que todas las personas que toman decisiones financieras que parecen extra√±as est√°n, de hecho, \"locas\".", correctAnswer: false, explanation: "Afirma que \"nadie est√° loco\"; las decisiones tienen sentido para el individuo seg√∫n sus experiencias √∫nicas. (Cap√≠tulo 1, Clave de Respuestas del Quiz)" },
            { statement: "El mayor beneficio que el dinero puede proporcionar, seg√∫n Housel, es la capacidad de comprar m√°s bienes de lujo.", correctAnswer: false, explanation: "El mayor beneficio es la libertad y el control sobre tu tiempo. (Cap√≠tulo 7, Clave de Respuestas del Quiz)" },
            { statement: "El √©xito financiero es casi enteramente el resultado de decisiones individuales acertadas, con poca o ninguna influencia de la suerte o el riesgo.", correctAnswer: false, explanation: "El libro da gran importancia a la suerte y el riesgo como factores significativos. (Cap√≠tulo 2)" },
            { statement: "El concepto de \"suficiente\" implica que uno nunca debe dejar de aspirar a acumular m√°s riqueza, sin importar cu√°nto ya se posea.", correctAnswer: false, explanation: "El concepto de \"suficiente\" es crucial para evitar la codicia y la ruina; saber cu√°ndo parar es vital. (Cap√≠tulo 3, Glosario)" },
            { statement: "Interrumpir el proceso de inter√©s compuesto con frecuencia no tiene un impacto significativo en la acumulaci√≥n de riqueza a largo plazo.", correctAnswer: false, explanation: "El poder del inter√©s compuesto reside en el tiempo y en no interrumpirlo. (Cap√≠tulo 4, Glosario)" },
            { statement: "Las habilidades y la mentalidad necesarias para hacerse rico son id√©nticas a las necesarias para conservar la riqueza.", correctAnswer: false, explanation: "Hacerse rico puede implicar tomar riesgos y ser optimista, mientras que conservar la riqueza requiere austeridad y paranoia/miedo a perderlo. (Cap√≠tulo 5)" },
            { statement: "La verdadera riqueza de una persona siempre es evidente a trav√©s de su estilo de vida y las posesiones que muestra.", correctAnswer: false, explanation: "La riqueza es lo que no se ve, los activos no gastados, no las demostraciones externas. (Cap√≠tulo 9)" },
            { statement: "Para tomar buenas decisiones financieras, siempre es mejor ser estrictamente \"racional\" (basado en datos y f√≥rmulas) que ser \"razonable\" (considerando el contexto emocional y pr√°ctico).", correctAnswer: false, explanation: "Housel argumenta que a menudo es mejor ser \"razonable\" (tomar decisiones que te permitan dormir por la noche y mantener el rumbo) que estrictamente \"racional\". (Cap√≠tulo 11, Glosario)" },
            { statement: "Tener un \"margen de error\" o \"margen para equivocarse\" en los planes financieros no es importante si se ha realizado una investigaci√≥n exhaustiva.", correctAnswer: false, explanation: "El margen de error es fundamental porque el futuro es incierto y los imprevistos ocurren. (Cap√≠tulo 13, Glosario)" },
            { statement: "La \"ilusi√≥n del fin de la historia\" nos ayuda a planificar con precisi√≥n nuestras metas financieras a muy largo plazo porque sabemos que no cambiaremos mucho.", correctAnswer: false, explanation: "La \"ilusi√≥n del fin de la historia\" nos hace subestimar cu√°nto cambiaremos, lo que dificulta la planificaci√≥n r√≠gida. (Cap√≠tulo 14, Clave de Respuestas del Quiz)" },
            { statement: "La volatilidad del mercado debe considerarse principalmente como una \"multa\" o un castigo por haber tomado malas decisiones de inversi√≥n.", correctAnswer: false, explanation: "Se debe ver como una \"tarifa\", el precio que se paga por la oportunidad de obtener rendimientos a largo plazo. (Cap√≠tulo 15, Clave de Respuestas del Quiz)" },
            { statement: "Todos los inversores en el mercado est√°n jugando el mismo \"juego\" con los mismos objetivos y horizontes temporales.", correctAnswer: false, explanation: "Diferentes inversores juegan diferentes \"juegos\" con distintos objetivos y plazos, lo cual es crucial entender. (Cap√≠tulo 16, Clave de Respuestas del Quiz)" },
            { statement: "La tasa de ahorro personal es menos importante para construir riqueza que obtener altos ingresos o lograr grandes rendimientos de inversi√≥n.", correctAnswer: false, explanation: "La tasa de ahorro es identificada como el factor m√°s controlable e importante para acumular riqueza. (Cap√≠tulo 10, Glosario)" },
            { statement: "El control emocional es un aspecto secundario en las finanzas si se poseen conocimientos t√©cnicos avanzados.", correctAnswer: false, explanation: "El comportamiento y el control emocional son primordiales, incluso m√°s que el conocimiento t√©cnico. (Introducci√≥n, Clave de Respuestas del Quiz)" },
            { statement: "Las experiencias personales pasadas de un individuo con el dinero tienen un impacto m√≠nimo en c√≥mo toman decisiones financieras en el presente.", correctAnswer: false, explanation: "Las experiencias personales moldean profundamente las decisiones financieras de cada individuo. (Cap√≠tulo 1)" },
            { statement: "Housel enfatiza que el objetivo final de la gesti√≥n del dinero debe ser maximizar los rendimientos de inversi√≥n a cualquier costo.", correctAnswer: false, explanation: "El objetivo principal que Housel resalta es la independencia financiera y el control sobre el propio tiempo. (Cap√≠tulo 7, Glosario)" },
            { statement: "La historia del ejecutivo tecnol√≥gico que se arruin√≥ y la del conserje Ronald Read que acumul√≥ una fortuna demuestran que el comportamiento es un motor m√°s potente del √©xito financiero que la inteligencia.", correctAnswer: true, explanation: "Estas historias introductorias son ejemplos clave de esta tesis central del libro. (Introducci√≥n)" }
        ];

        let currentQuestionIndex = 0;
        let score = 0;
        let answeredCurrentQuestion = false;

        // Las referencias a elementos del DOM son seguras aqu√≠ porque los IDs son √∫nicos
        // y se buscan despu√©s de que el HTML del juego es inyectado.
        const questionTextElement = document.getElementById('questionText');
        const trueButton = document.getElementById('trueButton');
        const falseButton = document.getElementById('falseButton');
        const feedbackArea = document.getElementById('feedbackArea');
        const feedbackResultElement = document.getElementById('feedbackResult');
        const correctAnswerTextElement = document.getElementById('correctAnswerText');
        const explanationTextElement = document.getElementById('explanationText');
        const questionCounterElement = document.getElementById('questionCounter');
        const scoreDisplayElement = document.getElementById('scoreDisplay');
        const prevButton = document.getElementById('prevButton');
        const nextButton = document.getElementById('nextButton');
        const finalScoreArea = document.getElementById('finalScoreArea');
        const finalScoreText = document.getElementById('finalScoreText');

        function loadQuestion(index) {
            const question = questions[index];
            questionTextElement.textContent = question.statement;
            
            feedbackArea.style.display = 'none';
            trueButton.disabled = false;
            falseButton.disabled = false;
            answeredCurrentQuestion = false;
            
            questionCounterElement.textContent = `Pregunta ${index + 1} / ${questions.length}`;
            prevButton.disabled = (index === 0);
            nextButton.disabled = (index === questions.length - 1);
            if (index === questions.length -1) {
                nextButton.textContent = "Finalizar Juego";
            } else {
                nextButton.textContent = "Siguiente ‚û°Ô∏è";
            }
        }

        // Las funciones handleAnswer, updateScoreDisplay, etc., tambi√©n quedan dentro del IIFE
        // y no contaminar√°n el √°mbito global.
        // Las llamadas onclick="handleAnswer(true)" en el HTML seguir√°n funcionando
        // si las funciones est√°n definidas ANTES de que el IIFE termine,
        // o si las adjuntas mediante addEventListener dentro del IIFE.
        // Por simplicidad, el script actual asume que las funciones son accesibles globalmente
        // DESPU√âS de que el script del juego se carga.
        // Un IIFE hace que no sean globales. Para que los onclick HTML funcionen,
        // necesitar√≠amos adjuntar las funciones al objeto window o usar addEventListener.

        // Opci√≥n 1: Adjuntar al window (menos ideal pero funciona para onclick)
        // window.handleAnswer = function(userAnswer) { ... }
        // window.previousQuestion = function() { ... }
        // etc.

        // Opci√≥n 2: Usar addEventListener (mejor pr√°ctica)
        // Esto requerir√≠a quitar los onclick="" del HTML y a√±adirlos aqu√≠:
        // trueButton.addEventListener('click', () => handleAnswer(true));
        // falseButton.addEventListener('click', () => handleAnswer(false));
        // prevButton.addEventListener('click', previousQuestion);
        // nextButton.addEventListener('click', nextQuestion);
        // document.querySelector('.vf-game-wrapper .final-score button').addEventListener('click', initializeGame);

        // Por ahora, mantendr√© la estructura simple y asumir√© que la ejecuci√≥n del script
        // y la disponibilidad de funciones para los `onclick` se maneja bien por la forma en que se cargan.
        // El problema principal es la colisi√≥n de variables, que el IIFE soluciona.
        // Si los onclick dejaran de funcionar, la Opci√≥n 2 (addEventListener) ser√≠a la soluci√≥n robusta.

        function handleAnswer(userAnswer) {
            if (answeredCurrentQuestion) return;
            answeredCurrentQuestion = true;

            const question = questions[currentQuestionIndex];
            const isCorrect = (userAnswer === question.correctAnswer);

            feedbackArea.style.display = 'block';
            if (isCorrect) {
                feedbackResultElement.textContent = "¬°Correcto!";
                // No es necesario prefijar 'vf-game-wrapper' aqu√≠ si ya se aplic√≥ al elemento feedbackArea
                feedbackArea.className = 'feedback-area feedback-correct'; 
                score++;
            } else {
                feedbackResultElement.textContent = "Incorrecto.";
                feedbackArea.className = 'feedback-area feedback-incorrect';
            }
            
            correctAnswerTextElement.textContent = question.correctAnswer ? "Verdadero" : "Falso";
            explanationTextElement.innerHTML = question.explanation.replace(/\n/g, "<br>");

            trueButton.disabled = true;
            falseButton.disabled = true;
            updateScoreDisplay();
        }
        
        function updateScoreDisplay() {
            scoreDisplayElement.textContent = `Puntuaci√≥n: ${score} / ${questions.length}`;
        }

        function nextQuestion() {
            if (currentQuestionIndex < questions.length - 1) {
                currentQuestionIndex++;
                loadQuestion(currentQuestionIndex);
            } else {
                showFinalScore();
            }
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                loadQuestion(currentQuestionIndex);
            }
        }
        
        function showFinalScore() {
            // Al usar querySelector, es bueno ser espec√≠fico si hay riesgo de colisi√≥n,
            // pero con el wrapper, .vf-game-wrapper .clase ya es espec√≠fico.
            // Si los elementos son √∫nicos por ID, getElementById es suficiente.
            document.querySelector('.vf-game-wrapper .question-area').style.display = 'none';
            document.querySelector('.vf-game-wrapper .answer-buttons').style.display = 'none';
            document.querySelector('.vf-game-wrapper .navigation-controls').style.display = 'none';
            scoreDisplayElement.style.display = 'none'; 
            feedbackArea.style.display = 'none'; 

            finalScoreText.textContent = `Tu puntuaci√≥n final es: ${score} de ${questions.length}.`;
            finalScoreArea.style.display = 'block';
        }

        function initializeGame() {
            currentQuestionIndex = 0;
            score = 0;
            answeredCurrentQuestion = false;
            
            const gameContainer = document.querySelector('.vf-game-wrapper .game-container');
            if (gameContainer) {
                 gameContainer.querySelector('.question-area').style.display = 'flex';
                 gameContainer.querySelector('.answer-buttons').style.display = 'block';
                 gameContainer.querySelector('.navigation-controls').style.display = 'flex';
            }
            scoreDisplayElement.style.display = 'block';
            finalScoreArea.style.display = 'none';
            feedbackArea.style.display = 'none'; // Asegurarse que el feedback se oculte al reiniciar

            loadQuestion(currentQuestionIndex);
            updateScoreDisplay();
        }
        
        // Para que los onclick HTML funcionen con el IIFE, necesitamos exponer las funciones:
        window.handleAnswer = handleAnswer;
        window.previousQuestion = previousQuestion;
        window.nextQuestion = nextQuestion;
        window.initializeGame = initializeGame; // Para el bot√≥n "Jugar de Nuevo"

        // Inicializaci√≥n del juego
        if (document.readyState === 'loading') {
            // Si el script se carga antes de que el DOM est√© listo (poco probable con la inyecci√≥n din√°mica)
            document.addEventListener('DOMContentLoaded', initializeGame);
        } else {
            // Si el DOM ya est√° listo (lo m√°s com√∫n con la inyecci√≥n din√°mica de scripts)
            initializeGame();
        }
    })(); // Fin del IIFE
    </script>
</body>
</html>
