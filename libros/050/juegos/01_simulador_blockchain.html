<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador de Blockchain</title>
    
    <style>
        body {
            font-family: 'Courier New', Courier, monospace;
            background-color: #0a0a12;
            color: #00ff41;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .container {
            background: #111;
            border: 1px solid #333;
            border-radius: 5px;
            padding: 30px;
            max-width: 900px;
            width: 100%;
            box-shadow: 0 0 20px rgba(0, 255, 65, 0.1);
        }
        h1 {
            text-align: center;
            text-transform: uppercase;
            letter-spacing: 3px;
            margin-bottom: 10px;
            color: #fff;
            border-bottom: 2px solid #00ff41;
            padding-bottom: 10px;
        }
        .subtitle {
            text-align: center;
            color: #888;
            margin-bottom: 30px;
        }
        .btn {
            background: transparent;
            color: #00ff41;
            border: 1px solid #00ff41;
            padding: 10px 20px;
            cursor: pointer;
            font-family: inherit;
            font-weight: bold;
            transition: all 0.3s;
            margin: 5px;
            text-transform: uppercase;
        }
        .btn:hover {
            background: #00ff41;
            color: #000;
            box-shadow: 0 0 10px #00ff41;
        }
        .card {
            background: #1a1a1a;
            padding: 20px;
            border: 1px solid #444;
            margin-bottom: 20px;
        }
        input, select, textarea {
            width: 100%;
            padding: 10px;
            background: #000;
            border: 1px solid #333;
            color: #fff;
            font-family: inherit;
            margin: 5px 0 15px 0;
        }
        input:focus, select:focus, textarea:focus {
            border-color: #00ff41;
            outline: none;
        }
        .result-area {
            margin-top: 20px;
            padding: 15px;
            border: 1px dashed #00ff41;
            display: none;
            background: #050505;
        }
        .slider-container {
            margin: 15px 0;
        }
        label {
            display: block;
            color: #aaa;
            margin-bottom: 5px;
        }
        .hash {
            word-break: break-all;
            font-size: 0.8em;
            color: #555;
        }
    </style>

</head>
<body>
    <div class="container">
        <h1>Simulador de Blockchain</h1>
        
        <p class="subtitle">Entiende cómo se encadenan los bloques mediante hash.</p>
        
        <div id="chain"></div>
        
        <button class="btn" onclick="addBlock()">Minar Nuevo Bloque</button>
        <button class="btn" onclick="resetChain()" style="border-color: #ff3333; color: #ff3333;">Reiniciar Cadena</button>

        <script>
            let chain = [];
            
            function simpleHash(str) {
                let hash = 0;
                for (let i = 0; i < str.length; i++) {
                    const char = str.charCodeAt(i);
                    hash = (hash << 5) - hash + char;
                    hash = hash & hash;
                }
                return Math.abs(hash).toString(16).padStart(64, '0');
            }

            function createBlock(index, previousHash, data) {
                const timestamp = new Date().toLocaleTimeString();
                const hash = simpleHash(index + previousHash + timestamp + data);
                return { index, timestamp, data, previousHash, hash };
            }

            function renderChain() {
                const container = document.getElementById('chain');
                container.innerHTML = '';
                
                chain.forEach((block, i) => {
                    container.innerHTML += `
                        <div class="card" style="border-left: 5px solid ${i===0 ? '#00ff41' : '#0088ff'};">
                            <h3>Bloque #${block.index} ${i===0 ? '(Génesis)' : ''}</h3>
                            <p><strong>Timestamp:</strong> ${block.timestamp}</p>
                            <p><strong>Data:</strong> <input type="text" value="${block.data}" oninput="updateData(${i}, this.value)" style="width: 200px; display:inline-block;"></p>
                            <p><strong>Prev Hash:</strong> <span class="hash">${block.previousHash}</span></p>
                            <p><strong>Hash:</strong> <span class="hash" id="hash-${i}" style="color: ${isValid(i) ? '#00ff41' : '#ff3333'}">${block.hash}</span></p>
                        </div>
                        ${i < chain.length - 1 ? '<div style="text-align:center; font-size:20px;">⬇️</div>' : ''}
                    `;
                });
            }
            
            function isValid(index) {
                if (index === 0) return true; // Genesis always valid for simplicity here
                const current = chain[index];
                const prev = chain[index-1];
                return current.previousHash === prev.hash;
            }

            function addBlock() {
                const prevBlock = chain[chain.length - 1];
                const newBlock = createBlock(chain.length, prevBlock.hash, "Transacción " + chain.length);
                chain.push(newBlock);
                renderChain();
            }
            
            function updateData(index, newData) {
                chain[index].data = newData;
                // Re-calculate hash for this block
                chain[index].hash = simpleHash(chain[index].index + chain[index].previousHash + chain[index].timestamp + newData);
                
                // Propagate changes (avalanche effect simulation)
                for(let i = index + 1; i < chain.length; i++) {
                    chain[i].previousHash = chain[i-1].hash;
                    chain[i].hash = simpleHash(chain[i].index + chain[i].previousHash + chain[i].timestamp + chain[i].data);
                }
                
                renderChain();
            }

            function resetChain() {
                chain = [createBlock(0, "0".repeat(64), "Bloque Génesis")];
                renderChain();
            }
            
            // Init
            resetChain();
        </script>
        
    </div>
</body>
</html>