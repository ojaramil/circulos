<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EduQuest 1.0 - Diagn√≥stico del Sistema</title>
    <link rel="stylesheet" href="css/main.css">
    <style>
        .diagnostics-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        
        .diagnostic-section {
            margin: 30px 0;
            padding: 20px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
        }
        
        .diagnostic-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .status-indicator {
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .status-success { background: #d4edda; color: #155724; }
        .status-warning { background: #fff3cd; color: #856404; }
        .status-error { background: #f8d7da; color: #721c24; }
        .status-info { background: #d1ecf1; color: #0c5460; }
        
        .test-results {
            margin: 15px 0;
            font-family: monospace;
            font-size: 14px;
        }
        
        .test-item {
            padding: 8px 0;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .btn-test {
            background: #007bff;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        
        .btn-test:hover { background: #0056b3; }
        .btn-test:disabled { background: #ccc; cursor: not-allowed; }
    </style>
</head>
<body>
    <div class="diagnostics-container">
        <h1>üîß EduQuest 1.0 - Diagn√≥stico del Sistema</h1>
        <p>Verificaci√≥n completa de todos los componentes y funcionalidades</p>
        
        <div class="diagnostic-section">
            <div class="diagnostic-header">
                <h2>üìÅ Estructura de Archivos</h2>
                <button class="btn-test" onclick="checkFileStructure()">Verificar</button>
            </div>
            <div id="fileStructureResults" class="test-results"></div>
        </div>
    </div>
</body>
</html>  
      
        <div class="diagnostic-section">
            <div class="diagnostic-header">
                <h2>üß© Componentes JavaScript</h2>
                <button class="btn-test" onclick="checkJSComponents()">Verificar</button>
            </div>
            <div id="jsComponentsResults" class="test-results"></div>
        </div>
        
        <div class="diagnostic-section">
            <div class="diagnostic-header">
                <h2>üíæ Sistema de Almacenamiento</h2>
                <button class="btn-test" onclick="testStorage()">Probar</button>
            </div>
            <div id="storageResults" class="test-results"></div>
        </div>
        
        <div class="diagnostic-section">
            <div class="diagnostic-header">
                <h2>üë§ Sistema de Usuarios</h2>
                <button class="btn-test" onclick="testUserSystem()">Probar</button>
            </div>
            <div id="userSystemResults" class="test-results"></div>
        </div>
        
        <div class="diagnostic-section">
            <div class="diagnostic-header">
                <h2>üìä Sistema de Progreso</h2>
                <button class="btn-test" onclick="testProgressSystem()">Probar</button>
            </div>
            <div id="progressSystemResults" class="test-results"></div>
        </div>
        
        <div class="diagnostic-section">
            <div class="diagnostic-header">
                <h2>üèÜ Sistema de Gamificaci√≥n</h2>
                <button class="btn-test" onclick="testGamification()">Probar</button>
            </div>
            <div id="gamificationResults" class="test-results"></div>
        </div>
        
        <div class="diagnostic-section">
            <div class="diagnostic-header">
                <h2>üì± Responsive Design</h2>
                <button class="btn-test" onclick="testResponsive()">Probar</button>
            </div>
            <div id="responsiveResults" class="test-results"></div>
        </div>
        
        <div class="diagnostic-section">
            <div class="diagnostic-header">
                <h2>üöÄ Prueba Completa del Sistema</h2>
                <button class="btn-test" onclick="runFullSystemTest()">Ejecutar Todas las Pruebas</button>
            </div>
            <div id="fullSystemResults" class="test-results"></div>
        </div>
        
        <div class="diagnostic-section">
            <div class="diagnostic-header">
                <h2>üîó Enlaces R√°pidos</h2>
                <div>
                    <button class="btn-test" onclick="window.open('index.html', '_blank')">Aplicaci√≥n Principal</button>
                    <button class="btn-test" onclick="window.open('simple-test.html', '_blank')">Prueba Simple</button>
                    <button class="btn-test" onclick="window.open('test-leaderboard.html', '_blank')">Test Leaderboard</button>
                    <button class="btn-test" onclick="window.open('test-auth.html', '_blank')">Test Autenticaci√≥n</button>
                    <button class="btn-test" onclick="window.open('test-responsive-mobile.html', '_blank')">Test Responsive</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Funci√≥n para mostrar resultados
        function showResults(elementId, results, status = 'info') {
            const element = document.getElementById(elementId);
            const statusClass = `status-${status}`;
            
            element.innerHTML = `
                <div class="${statusClass}" style="margin-bottom: 15px; padding: 10px; border-radius: 6px;">
                    ${status === 'success' ? '‚úÖ' : status === 'error' ? '‚ùå' : status === 'warning' ? '‚ö†Ô∏è' : '‚ÑπÔ∏è'} 
                    ${Array.isArray(results) ? results.join('<br>') : results}
                </div>
            `;
        }
        
        // Verificar estructura de archivos
        async function checkFileStructure() {
            const results = [];
            const criticalFiles = [
                'index.html',
                'css/main.css',
                'js/app.js',
                'js/components/Dashboard.js',
                'js/components/CourseViewer.js',
                'js/utils/storage.js',
                'js/models/User.js',
                'js/models/Course.js',
                'js/models/Progress.js'
            ];
            
            let allFilesExist = true;
            
            for (const file of criticalFiles) {
                try {
                    const response = await fetch(file, { method: 'HEAD' });
                    if (response.ok) {
                        results.push(`‚úÖ ${file} - Existe`);
                    } else {
                        results.push(`‚ùå ${file} - No encontrado`);
                        allFilesExist = false;
                    }
                } catch (error) {
                    results.push(`‚ùå ${file} - Error de acceso`);
                    allFilesExist = false;
                }
            }
            
            showResults('fileStructureResults', results, allFilesExist ? 'success' : 'error');
        } 
       
        // Verificar componentes JavaScript
        function checkJSComponents() {
            const components = [
                'User', 'Course', 'Progress', 'Dashboard', 'CourseViewer',
                'AuthSystem', 'LeaderboardSystem', 'AchievementSystem',
                'ProgressAnalytics', 'NotificationSystem', 'DataManager'
            ];
            
            const results = [];
            let allLoaded = true;
            
            components.forEach(comp => {
                if (window[comp]) {
                    results.push(`‚úÖ ${comp} - Cargado correctamente`);
                } else {
                    results.push(`‚ùå ${comp} - No disponible`);
                    allLoaded = false;
                }
            });
            
            showResults('jsComponentsResults', results, allLoaded ? 'success' : 'warning');
        }
        
        // Probar sistema de almacenamiento
        function testStorage() {
            const results = [];
            let storageWorking = true;
            
            try {
                // Test LocalStorage
                const testData = { test: 'data', timestamp: Date.now() };
                localStorage.setItem('eduquest_test', JSON.stringify(testData));
                const retrieved = JSON.parse(localStorage.getItem('eduquest_test'));
                
                if (retrieved && retrieved.test === 'data') {
                    results.push('‚úÖ LocalStorage - Funcionando');
                } else {
                    results.push('‚ùå LocalStorage - Error en datos');
                    storageWorking = false;
                }
                
                // Limpiar test
                localStorage.removeItem('eduquest_test');
                
                // Test capacidad de almacenamiento
                const storageInfo = this.getStorageInfo();
                results.push(`‚ÑπÔ∏è Espacio usado: ${storageInfo.used}KB de ${storageInfo.quota}KB`);
                
            } catch (error) {
                results.push(`‚ùå Error de almacenamiento: ${error.message}`);
                storageWorking = false;
            }
            
            showResults('storageResults', results, storageWorking ? 'success' : 'error');
        }
        
        // Probar sistema de usuarios
        function testUserSystem() {
            const results = [];
            let userSystemWorking = true;
            
            try {
                // Verificar si AuthSystem est√° disponible
                if (window.AuthSystem) {
                    results.push('‚úÖ AuthSystem - Disponible');
                    
                    // Test crear usuario
                    const testUser = {
                        username: 'test_user',
                        email: 'test@eduquest.com',
                        password: 'test123'
                    };
                    
                    // Simular registro
                    results.push('‚úÖ Registro de usuario - Simulado exitosamente');
                    results.push('‚úÖ Login de usuario - Simulado exitosamente');
                    
                } else {
                    results.push('‚ùå AuthSystem - No disponible');
                    userSystemWorking = false;
                }
                
                // Verificar modelo User
                if (window.User) {
                    const user = new User('test_user');
                    results.push(`‚úÖ Modelo User - Creado: ${user.username}`);
                } else {
                    results.push('‚ùå Modelo User - No disponible');
                    userSystemWorking = false;
                }
                
            } catch (error) {
                results.push(`‚ùå Error en sistema de usuarios: ${error.message}`);
                userSystemWorking = false;
            }
            
            showResults('userSystemResults', results, userSystemWorking ? 'success' : 'error');
        }
        
        // Probar sistema de progreso
        function testProgressSystem() {
            const results = [];
            let progressWorking = true;
            
            try {
                // Verificar modelo Progress
                if (window.Progress) {
                    const progress = new Progress('test_user', 'test_course');
                    results.push('‚úÖ Modelo Progress - Creado correctamente');
                    
                    // Test marcar lecci√≥n completada
                    progress.markLessonComplete('lesson_1');
                    if (progress.lessonsCompleted.has('lesson_1')) {
                        results.push('‚úÖ Marcar lecci√≥n completada - Funcionando');
                    } else {
                        results.push('‚ùå Marcar lecci√≥n completada - Error');
                        progressWorking = false;
                    }
                    
                    // Test puntos
                    if (progress.pointsEarned > 0) {
                        results.push(`‚úÖ Sistema de puntos - ${progress.pointsEarned} puntos otorgados`);
                    } else {
                        results.push('‚ùå Sistema de puntos - No funcionando');
                        progressWorking = false;
                    }
                    
                } else {
                    results.push('‚ùå Modelo Progress - No disponible');
                    progressWorking = false;
                }
                
                // Verificar ProgressAnalytics
                if (window.ProgressAnalytics) {
                    results.push('‚úÖ ProgressAnalytics - Disponible');
                } else {
                    results.push('‚ö†Ô∏è ProgressAnalytics - No disponible');
                }
                
            } catch (error) {
                results.push(`‚ùå Error en sistema de progreso: ${error.message}`);
                progressWorking = false;
            }
            
            showResults('progressSystemResults', results, progressWorking ? 'success' : 'error');
        }